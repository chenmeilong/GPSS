function getWebPath(){var a=window.document.location.href,b=window.document.location.pathname,c=a.indexOf(b),d=a.substring(0,c),e=b.substring(0,b.substr(1).indexOf("/")+1);return d+e}function bindDictSelect(a,b,c){c=c||"",$.post("base/dict/listBySym",{parentSym:a,container:b},function(a){var e,d=a.rows;if(null!=d){for(b=a.container,$("#"+b).append("<option value=''></option>"),e=0;e<d.length;e++)$("#"+b).append("<option value='"+d[e].title+"'>"+d[e].title+"</option>");c&&c(b),"undefined"!=typeof dictCallBack&&dictCallBack(b)}})}function checkForEnter(a){var b,c,d;return 13!=a.keyCode||"button"==$(this).attr("type")||"submit"==$(this).attr("type")||$(this).is("textarea")||"textarea"==$(this).attr("type")||"reset"==$(this).attr("type")||-1!=$(this).attr("id").indexOf("At")?void 0:(b=$(".enterIndex").index($(this)),c=$(".enterIndex").length,c-1>b&&("radio"!=$(this).attr("type")?nextDOM($(".enterIndex"),b):(d=$(".enterIndex").index($(".enterIndex[type=radio][name="+$(this).attr("name")+"]:last")),nextDOM($(".enterIndex"),d))),!1)}function nextDOM(a,b){a.eq(b+1)[0].disabled?nextDOM(a,b+1):a.eq(b+1).trigger("focus")}function isIdCardNo(a){var c,d,e,f,b=a.length;if(15==b)c=new RegExp(/^(\d{6})()?(\d{2})(\d{2})(\d{2})(\d{2})(\w)$/);else{if(18!=b)return!1;c=new RegExp(/^(\d{6})()?(\d{4})(\d{2})(\d{2})(\d{3})(\w)$/)}return d=a.match(c),null==d||(15==b?(e=new Date("19"+d[3]+"/"+d[4]+"/"+d[5]),f=e.getYear()==d[3]&&e.getMonth()+1==d[4]&&e.getDate()==d[5]):(e=new Date(d[3]+"/"+d[4]+"/"+d[5]),f=e.getFullYear()==d[3]&&e.getMonth()+1==d[4]&&e.getDate()==d[5]),f)?c.test(a)?!0:!1:!1}function isPlateNo(a){var b=/^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;return b.test(a)?!0:!1}function commafy(a,b){return b=b||0,a=parseFloat(a),isNaN(a)?"0.00":(a.toFixed(b)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")}function clearNoNum(a){a.value=a.value.replace(/[^\d.]/g,""),a.value=a.value.replace(/^\./g,""),a.value=a.value.replace(/\.{2,}/g,"."),a.value=a.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")}function clearCommafy(a){return a?""==(a+"").trim()?"":a=a.replace(/,/gi,""):0}function showAlbum(a){if(a){var b={title:a.title,id:a.id,start:a.start,data:a.data};layer.photos({photos:b})}}function getImgRealWH(a){var b=document.createElement("img");return b.src=a,{w:b.width,h:b.height}}function jsonDateTimeFormatter(a,b){var c,d;return b=b||0,null==a||""==a?"":("string"==typeof a&&a.indexOf("Date")>=0&&(a=a.replace("/Date(","").replace(")/","")),c=new Date(parseInt(a,10)),d=c.getFullYear()+"-"+(c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1)+"-"+(c.getDate()<10?"0"+c.getDate():c.getDate()),1==b?d+=" "+(c.getHours()<10?"0"+c.getHours():c.getHours())+":"+(c.getMinutes()<10?"0"+c.getMinutes():c.getMinutes()):2==b&&(d+=" "+(c.getHours()<10?"0"+c.getHours():c.getHours())+":"+(c.getMinutes()<10?"0"+c.getMinutes():c.getMinutes())+":"+(c.getSeconds()<10?"0"+c.getSeconds():c.getSeconds())),d)}function currentDateTime(a){return a=a||0,0==a?Date.currentTime():Date.currentDate()}function dateToStr(a,b){var c,d,e,f,g,h,i;return b=b||0,c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate(),f=a.getHours(),g=a.getMinutes(),h=a.getSeconds(),10>d&&(d="0"+d),10>e&&(e="0"+e),10>f&&(f="0"+f),10>g&&(g="0"+g),10>h&&(h="0"+h),i="",0==b&&(i=c+"-"+d+"-"+e),1==b&&(i=c+"-"+d+"-"+e+" "+f+":"+g+":"+h),i}function accDiv(arg1,arg2,arg3){var r1,r2,t1=0,t2=0;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),toDecimal(r1/r2*pow(10,t2-t1),arg3)}function accMul(a,b,c){var d=0,e=a.toString(),f=b.toString();try{d+=e.split(".")[1].length}catch(g){}try{d+=f.split(".")[1].length}catch(g){}return toDecimal(Number(e.replace(".",""))*Number(f.replace(".",""))/Math.pow(10,d),c)}function toDecimal(a,b){var d,c=parseFloat(b);return isNaN(c)&&(b=2),d=Math.pow(10,b),Math.round(a*d)/d}function limitStr(a,b){return null!=a&&""!=a&&(a=removeHTMLTag(a),a.length>b&&(a=a.substring(0,b-1)+"...")),a}function removeHTMLTag(a){return a=a.replace(/<\/?[^>]*>/g,""),a=a.replace(/[ | ]*\n/g,"\n"),a=a.replace(/&nbsp;/gi,"")}var treeExpand,_Explorer="IE",explorer=navigator.userAgent;explorer.indexOf("MSIE")>=0?_Explorer="IE":explorer.indexOf("Firefox")>=0?_Explorer="Firefox":explorer.indexOf("Chrome")>=0?_Explorer="Chrome":explorer.indexOf("Opera")>=0?_Explorer="Opera":explorer.indexOf("Safari")>=0?_Explorer="Safari":explorer.indexOf("Netscape")>=0&&(_Explorer="Netscape"),"undefined"!=typeof jQuery.validator&&(jQuery.extend(jQuery.validator.defaults,{errorElement:"span",errorClass:"help-block",focusInvalid:!0,highlight:function(a){$(a).closest("div").addClass("has-error")},success:function(a){a.closest("div").removeClass("has-error"),a.remove()},errorPlacement:function(a,b){$(b).closest("div").append(a)}}),jQuery.extend(jQuery.validator.messages,{required:"不能为空",remote:"请修正该字段",email:"请输入正确格式的电子邮件",url:"请输入合法的网址",date:"请输入合法的日期",dateISO:"请输入合法的日期 (ISO).",number:"请输入合法的数字",digits:"只能输入整数",creditcard:"请输入合法的信用卡号",equalTo:"请再次输入相同的值",accept:"请输入拥有合法后缀名的字符串",maxlength:jQuery.validator.format("请输入一个 长度最多是 {0} 的字符串"),minlength:jQuery.validator.format("请输入一个 长度最少是 {0} 的字符串"),rangelength:jQuery.validator.format("请输入 一个长度介于 {0} 和 {1} 之间的字符串"),range:jQuery.validator.format("请输入一个介于 {0} 和 {1} 之间的值"),max:jQuery.validator.format("请输入一个最大为{0} 的值"),min:jQuery.validator.format("请输入一个最小为{0} 的值")}),$.validator.addMethod("mobile",function(a,b){return this.optional(b)||/^1\d{10}$/.test(a)},"请输入正确的手机号码"),jQuery.validator.addMethod("phone",function(a,b){var c=/^(\d{3,4}-?)?\d{7,9}$/g;return this.optional(b)||c.test(a)},"请正确填写您的电话号码"),jQuery.validator.addMethod("mobilephone",function(a,b){var c=a.length,d=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/,e=/^(\d{3,4}-?)?\d{7,9}$/g;return this.optional(b)||e.test(a)||11==c&&d.test(a)},"请正确填写您的联系方式"),jQuery.validator.addMethod("qq",function(a,b){return this.optional(b)||/^[1-9]\d{4,12}$/},"请正确填写您的QQ"),jQuery.validator.addMethod("zipcode",function(a,b){var c=/^[0-9]{6}$/;return this.optional(b)||c.test(a)},"请正确填写您的邮政编码。"),jQuery.validator.addMethod("extPassword",function(a,b){return this.optional(b)||/^[a-zA-Z]\\w{6,12}$/.test(a)},"以字母开头，长度在6-12之间，只能包含字符、数字和下划线。"),jQuery.validator.addMethod("idCardNo",function(a,b){return this.optional(b)||isIdCardNo(a)},"请输入正确的身份证号码。"),jQuery.validator.addMethod("ip",function(a,b){return this.optional(b)||/^(([1-9]|([1-9]\d)|(1\d\d)|(2([0-4]\d|5[0-5])))\.)(([1-9]|([1-9]\d)|(1\d\d)|(2([0-4]\d|5[0-5])))\.){2}([1-9]|([1-9]\d)|(1\d\d)|(2([0-4]\d|5[0-5])))$/.test(a)},"请填写正确的IP地址。"),jQuery.validator.addMethod("string",function(a,b){return this.optional(b)||/^[a-zA-Z0-9\u4e00-\u9fa5-_]+$/.test(a)},"只能包含中文、英文、数字、下划线等字符"),jQuery.validator.addMethod("english",function(a,b){return this.optional(b)||/^[A-Za-z]+$/.test(a)},"匹配english"),jQuery.validator.addMethod("chinese",function(a,b){return this.optional(b)||/^[\u4e00-\u9fa5]+$/.test(a)},"匹配汉字"),jQuery.validator.addMethod("chineseChar",function(a,b){return this.optional(b)||/^[\u0391-\uFFE5]+$/.test(a)},"匹配中文(包括汉字和字符) "),jQuery.validator.addMethod("rightfulString",function(a,b){return this.optional(b)||/^[A-Za-z0-9_-]+$/.test(a)},"判断是否为合法字符(a-zA-Z0-9-_)"),jQuery.validator.addMethod("containsSpecialChar",function(a,b){var c=RegExp(/[(\ )(\`)(\~)(\!)(\@)(\#)(\$)(\%)(\^)(\&)(\*)(\()(\))(\+)(\=)(\|)(\{)(\})(\')(\:)(\;)(\')(',)(\[)(\])(\.)(\<)(\>)(\/)(\?)(\~)(\！)(\@)(\#)(\￥)(\%)(\…)(\&)(\*)(\（)(\）)(\—)(\+)(\|)(\{)(\})(\【)(\】)(\‘)(\；)(\：)(\”)(\“)(\’)(\。)(\，)(\、)(\？)]+/);return this.optional(b)||!c.test(a)},"含有中英文特殊字符")),$.jgrid&&($.jgrid.defaults.autowidth=!0,$.jgrid.defaults.datatype="json",$.jgrid.defaults.mtype="post",$.jgrid.defaults.styleUI="Bootstrap",$.jgrid.defaults.treedatatype="json",$.jgrid.defaults.treeGridModel="adjacency",$.jgrid.defaults.treeReader={parent_id_field:"baseTree.parentId",level_field:"baseTree.level",leaf_field:"baseTree.leaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},window.onresize=function(){"Chrome"==_Explorer&&$(".ui-jqgrid-bdiv").css("overflow-x","hidden"),$("#grid").setGridWidth(document.body.clientWidth-32)}),treeExpand=function(){for(var d,b=_expandPath.split("."),c=0;b.length>0;){if(""!=b[0]&&"0"!=b[0]){c=b[0],b.shift();break}b.shift()}d=$("#grid").jqGrid("getGridParam").data,0==b.length&&1==d.length&&(c=d[0].id),setTimeout(function(){var f,e=!1;for(f=0;f<d.length;f++)if(d[f].id==c){e=d[f];break}!e||e.expanded||e["baseTree.leaf"]||($("#grid").jqGrid("expandRow",e),$("#grid").jqGrid("expandNode",e)),b.length>0&&(_expandPath=b.join("."))},100)},$(document).ready(function(){$(":input:text:first").attr("ID")&&-1==$(":input:text:first").attr("ID").indexOf("At")&&$(":input:text:first").focus(),$(":input:enabled").addClass("enterIndex"),textboxes=$(".enterIndex"),textboxes.length>0&&textboxes[0].focus(),/msie/.test(navigator.userAgent.toLowerCase())?$(textboxes).bind("keydown",checkForEnter):$(textboxes).bind("keypress",checkForEnter)}),$(document).keyup(function(a){switch(a.keyCode){case 27:parent.layer?parent.layer.closeAll():layer.closeAll()}}),Date.formatdate=function(a,b,c,d){var h,i,j,k,e=b||"-",f=a.getFullYear(),g=a.getMonth()+1;return g=10>g?"0"+g:g,h=a.getDate(),h=10>h?"0"+h:h,i=a.getHours(),i=10>i?"0"+i:i,j=a.getMinutes(),j=10>j?"0"+j:j,k=Math.round(a.getSeconds()),k=10>k?"0"+k:k,d?f+e+g+e+h:c?f+e+g+e+h+" "+i+":"+j:f+e+g+e+h+" "+i+":"+j+":"+k},Date.currentDate=function(a){return Date.formatdate(new Date,a,!0,!0)},Date.currentTime=function(){return Date.formatdate(new Date,"-")},Number.prototype.div=function(a,b){return accDiv(this,a,b)},Number.prototype.mul=function(a,b){return accMul(a,this,b)},String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)};